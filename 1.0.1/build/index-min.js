/*!build time : 2014-04-24 12:12:13 PM*/
KISSY.add("gallery/simpleCountDown/1.0.1/index",function(){function a(a,b){return function(){a.apply(b,arguments)}}function b(a){this.id=a.id||0,this.node=a.node,this.tpl=a.tpl,this.leftTime=a.leftTime,this.totalTime=a.totalTime,this.triggers=[],this.stop=0,this.extraCal=function(){}}function c(a){this._timeStack=[],this._extraCal=[],this._count=0,this._precision=a||100,this._timmer=0,this._oldtime=(new Date).getTime(),this.init()}return b.prototype.addTrigger=function(a,b){var c={triggerTime:a,triggerFlag:!1,triggerFunc:b};this.triggers.push(c)},b.prototype.render=function(){var a,b,c,d,e,f=Math.floor(this.leftTime%1e3/100),g=Math.floor(this.leftTime/1e3%60),h=Math.floor(this.leftTime/6e4%60),i=Math.floor(this.leftTime/36e5%24),j=Math.floor(this.leftTime/864e5),k=Math.floor(this.leftTime/1e3),l=Math.floor(this.leftTime/6e4),m=Math.floor(this.leftTime/36e5);this.node[0]?(this.node[0].__cache||(this.node[0].__cache={msNode:this.node.all(".scd-digit-ms"),sNode:this.node.all(".scd-digit-s"),mNode:this.node.all(".scd-digit-m"),hNode:this.node.all(".scd-digit-h"),dNode:this.node.all(".scd-digit-d")}),a=this.node[0].__cache.msNode,b=this.node[0].__cache.sNode,c=this.node[0].__cache.mNode,d=this.node[0].__cache.hNode,e=this.node[0].__cache.dNode):(a=this.node.all(".scd-digit-ms"),b=this.node.all(".scd-digit-s"),c=this.node.all(".scd-digit-m"),d=this.node.all(".scd-digit-h"),e=this.node.all(".scd-digit-d")),a&&a.html(f),b[0]&&(c[0]?(10>g&&(g="0"+g),b.html(g)):(10>k&&(k="0"+k),b.html(k))),c[0]&&(d[0]?(10>h&&(h="0"+h),c.html(h)):(10>l&&(l="0"+l),c.html(l))),d[0]&&(e[0]?(10>i&&(i="0"+i),d.html(i)):(10>m&&(m="0"+m),d.html(m))),e[0]&&e.html(j)},b.prototype.update=function(){this.render(),this.extraCal()},b.prototype.reset=function(a){if(!this.stop){this.leftTime=a;for(var b=this.triggers.length;b--;)this.triggers[b].triggerFlag=!1}},c.prototype.init=function(){this.exec(),this._timmer=setTimeout(a(function(){this.init()},this),this._precision)},c.prototype._clear=function(){clearTimeout(this._timmer)},c.prototype.clearStack=function(){this._timeStack=[]},c.prototype.exec=function(){var b={},c=(new Date).getTime(),d=c-this._oldtime;this._oldtime=c;for(var e=this._timeStack.length;e--;)if(b=this._timeStack[e],b.stop)b.update();else{b.leftTime-=d,b.leftTime<0&&(b.leftTime=0),b.update();for(var f=b.triggers.length;f--;)b.triggers[f].triggerTime>=b.leftTime&&!b.triggers[f].triggerFlag&&(b.triggers[f].triggerFlag=!0,b.triggers[f].triggerFunc(b))}for(var g=0;g<this._extraCal.length;g++)a(this._extraCal[g],this)()},c.prototype.add=function(a,c,d){if(a[0]){var e=a.html().replace(/\$\{ms\}/gi,'<s class="scd-digit-ms"></s>').replace(/\$\{s\}/gi,'<s class="scd-digit-s"></s>').replace(/\$\{m\}/gi,'<s class="scd-digit-m"></s>').replace(/\$\{h\}/gi,'<s class="scd-digit-h"></s>').replace(/\$\{d\}/gi,'<s class="scd-digit-d"></s>'),f=void 0===c?void 0:c,g=a.attr("data-lefttime");a.html(e);var h={id:this._count++};h.node=a,h.tpl=e,h.leftTime=f||g||0,h.totalTime=d||c;var i=new b(h);return a[0]._s_countdown=i,this._timeStack.push(i),i}},c.prototype.get=function(a){if(a[0])return void 0;var b=a[0]._s_countdown;if(!b)return void 0;for(var c=this._timeStack.length;c--;)if(b.id==this._timeStack[c].id)return{item:b,index:c};return void 0},c.prototype.remove=function(a){var b=this.get(a);b&&this._timeStack.splice(b.index,1)},c.prototype.stop=function(a){var b=this.get(a);b.stop=1},c.prototype.addCal=function(a){this._extraCal.push(a)},c},{requires:[]});